%YAML 1.2
---
# http://www.sublimetext.com/docs/3/syntax.html
name: Objective-C++
scope: source.objc++
version: 2
extends:
  - Packages/Objective-C/Objective-C.sublime-syntax
  - Packages/C++/C++.sublime-syntax

file_extensions:
  - mm
  - M
  - h

first_line_match: |-
  (?xi:
    ^ \s* // .*? -\*- .*? \bobj(ective-)?(c\+\+|cpp\b) .*? -\*-  # editorconfig
  )

contexts:
  protocol-list:
    - include: template
  message-enclosure: []
  enclosure:
    - meta_prepend: true
    - match: (?=\[(?!\s*{{identifier}}\s*[:\]]))
      branch_point: message
      branch: [pre-message, pre-lambda]

  pre-lambda:
    - match: \[\[
      scope: meta.brackts.square.objc++ punctuation.section.brackets.begin.objc++
      set: enclosure.attribute
    - include: lambda-enclosure
    - include: pop-immediately